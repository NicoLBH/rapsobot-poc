<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RAPSOBOT PoC — UI</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">R</div>
      <div>
        <div class="title">RAPSOBOT — PoC</div>
        <div class="subtitle">Drill-down : Situations → Problèmes → Avis (cap 200)</div>
      </div>
    </div>

    <div class="pill" id="statusPill">—</div>
  </header>

  <main class="container">
    <section class="card">
      <h2>Entrées</h2>

      <div class="grid">
        <label class="field">
          <span>Commune + CP</span>
          <input id="communeCp" type="text" placeholder="ex: 74950 Scionzier" />
        </label>

        <label class="field">
          <span>Catégorie d’importance</span>
          <select id="importance">
            <option value="je ne sais pas">je ne sais pas</option>
            <option value="I">I</option>
            <option value="II">II</option>
            <option value="III">III</option>
            <option value="IV">IV</option>
          </select>
        </label>

        <label class="field">
          <span>Classe de sol</span>
          <select id="soilClass">
            <option value="je ne sais pas">je ne sais pas</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="S1">S1</option>
            <option value="S2">S2</option>
          </select>
        </label>

        <label class="field">
          <span>Liquéfaction</span>
          <select id="liquefaction">
            <option value="je ne sais pas">je ne sais pas</option>
            <option value="non">non</option>
            <option value="oui">oui</option>
          </select>
        </label>

        <label class="field">
          <span>Référentiel</span>
          <select id="referential">
            <option value="Eurocode 8">Eurocode 8</option>
            <option value="PS-MI 89 révisées 92">PS-MI 89 révisées 92</option>
            <option value="CP-MI Antilles">CP-MI Antilles</option>
          </select>
        </label>

        <label class="field">
          <span>Webhook URL (n8n)</span>
          <input id="webhookUrl" type="url" placeholder="https://.../webhook/rapsobot-poc" />
          <small class="hint">Peut aussi venir du query param <code>webhookUrl</code>.</small>
        </label>

        <label class="field">
          <span>PDF URL (optionnel)</span>
          <input id="pdfUrl" type="url" placeholder="https://.../document.pdf" />
          <small class="hint">Si ton workflow n8n ne télécharge pas le PDF par URL, laisse vide.</small>
        </label>
      </div>

      <div class="actions">
        <button id="runBtn" class="btn primary">Lancer l’analyse</button>
        <button id="resetBtn" class="btn">Réinitialiser</button>
      </div>

      <div id="runMeta" class="meta"></div>
      <div id="errorBox" class="error hidden"></div>
    </section>

    <section class="split">
      <section class="card">
        <div class="cardHeader">
          <h2>Situations</h2>
          <div class="small" id="sitCount">—</div>
        </div>
        <div id="situations" class="list emptyState">Lance une analyse pour afficher les situations.</div>
      </section>

      <section class="card">
        <div class="cardHeader">
          <h2>Problèmes</h2>
          <div class="small" id="pbCount">—</div>
        </div>
        <div id="problems" class="list emptyState">Sélectionne une situation.</div>
      </section>
    </section>

    <section class="card">
      <div class="cardHeader">
        <h2>Avis</h2>
        <div class="small" id="avCount">—</div>
      </div>

      <div class="toolbar">
        <label class="chip">
          Verdict
          <select id="verdictFilter">
            <option value="ALL">Tous</option>
            <option value="KO">KO</option>
            <option value="A_VERIFIER">A_VERIFIER</option>
            <option value="OK">OK</option>
          </select>
        </label>

        <label class="chip">
          Recherche
          <input id="searchBox" type="text" placeholder="topic / EC8 / mot-clé..." />
        </label>

        <div class="spacer"></div>

        <div class="chip">
          Page
          <button id="prevPage" class="btn small">◀</button>
          <span id="pageInfo" class="mono">1 / 1</span>
          <button id="nextPage" class="btn small">▶</button>
        </div>
      </div>

      <div id="avis" class="tableWrap emptyState">Sélectionne un problème.</div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
